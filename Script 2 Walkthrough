For this script I am going to skip over the trigger and crate user since those are the same as script 1
Here we are adding the option for multiple groups to show a more realistic scenario. Will also be adding a lcenses as well later
After the create user step we need to initialize variables. This can be a bit tedious. In this example we have the following departments:
Sales/Marketing, Human Resources, Customer Service, Production, Finance, Executive, and IT. Each of these has a corisponding group in Azure.
For each Department you need to initialize a variable, Label it with the department name, set it to string, then copy the group ID from Azure to the last field.
Sales and Marketing are the same group but crated a variable for each pointing to the same group. (So in my case it was 8 groups)
Now the next fun, yet tedious task, add a task and create a switch. The switch control ON field add: @triggerBody()?['Department']
Now we need to add a case for each department. Click on the plus in the empty area to add a case. Put the name of the department (e.g. sales) in the field
Below the case add an action and search for condition. When you see the True, click on the plus underneath and add the add user to group action under Entra.
Using the lightning bolt add Id to the user field and the group/department name to the group ID field. Repeat as often as necessary
